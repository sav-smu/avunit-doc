

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Semantics of Describing Specifications &mdash; AVUnit  documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Overall BNF" href="Overall_BNF.html" />
    <link rel="prev" title="Define Specifications by AVUnit" href="Build_specifications_by_AVUnit.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> AVUnit
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption" role="heading"><span class="caption-text">Getting started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="Introduction_to_AVUnit.html">Introduction to AVUnit</a></li>
<li class="toctree-l1"><a class="reference internal" href="Install_AVUnit.html">Install AVUnit</a></li>
<li class="toctree-l1"><a class="reference internal" href="AVUnit_examples.html">AVUnit examples</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Language Description</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="types.html">Types</a></li>
<li class="toctree-l1"><a class="reference internal" href="Generate_scenarios_by_AVUnit.html">Generate Scenarios by AVUnit</a></li>
<li class="toctree-l1"><a class="reference internal" href="Semantics_of_Describing_Scenes.html">Semantics of Describing Scenes</a></li>
<li class="toctree-l1"><a class="reference internal" href="Build_specifications_by_AVUnit.html">Define Specifications by AVUnit</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Semantics of Describing Specifications</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#expression-semantics">Expression Semantics</a></li>
<li class="toctree-l2"><a class="reference internal" href="#satistic-semantics">Satistic Semantics</a></li>
<li class="toctree-l2"><a class="reference internal" href="#quantitative-semantics">Quantitative Semantics</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="Overall_BNF.html">Overall BNF</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Extension to simulations</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="simulations.html">AVUnit connected to Simulator and Autonomous Vehicle</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">AVUnit</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Semantics of Describing Specifications</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/Semanticss_of_Defining_Specifications.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="semantics-of-describing-specifications">
<h1>Semantics of Describing Specifications<a class="headerlink" href="#semantics-of-describing-specifications" title="Permalink to this headline">¶</a></h1>
<p>In the following, we define the semantics of AVUnit (Specification Defination Part).</p>
<p>Let <span class="math notranslate nohighlight">\(vs(t)\)</span>, <span class="math notranslate nohighlight">\(p(t)\)</span>, <span class="math notranslate nohighlight">\(q(t)\)</span>, <span class="math notranslate nohighlight">\(v(t)\)</span>,  <span class="math notranslate nohighlight">\(a(t)\)</span>, and <span class="math notranslate nohighlight">\(\kappa(t)\)</span> be the speed, position, orientation, velocity,  acceleration, and shape at time instant <span class="math notranslate nohighlight">\(t\)</span>, where <span class="math notranslate nohighlight">\(vs(t)\in R\)</span>, <span class="math notranslate nohighlight">\(p(t), v(t), a(t) \in R^3\)</span>, <span class="math notranslate nohighlight">\(q(t)\in R^4\)</span> is a unit quaternion, and <span class="math notranslate nohighlight">\(\kappa(t)\)</span> is described as a polygon. We add the subscript to describe the related object.
Hence, at any time instant <span class="math notranslate nohighlight">\(t\)</span>, the status of the ego vehicle is denoted as
<span class="math notranslate nohighlight">\(X^e(t) =[p^e(t), q^e(t), v^e(t), a^e(t), \kappa^e(t)]\)</span>;
let
<span class="math notranslate nohighlight">\(X_i^\alpha(t)\)</span> <span class="math notranslate nohighlight">\(=\)</span> <span class="math notranslate nohighlight">\([p_i^\alpha(t)\)</span>, <span class="math notranslate nohighlight">\(q_i^\alpha(t)\)</span>, <span class="math notranslate nohighlight">\(v_i^\alpha(t)\)</span>, <span class="math notranslate nohighlight">\(a_i^\alpha(t)\)</span>,  <span class="math notranslate nohighlight">\(\kappa_i^\alpha(t)]\)</span> and
<span class="math notranslate nohighlight">\(X_i^\beta(t)\)</span> <span class="math notranslate nohighlight">\(=\)</span> <span class="math notranslate nohighlight">\([p_i^\beta(t)\)</span>, <span class="math notranslate nohighlight">\(q_i^\beta(t)\)</span>, <span class="math notranslate nohighlight">\(v_i^\beta(t)\)</span>, <span class="math notranslate nohighlight">\(a_i^\beta(t)\)</span>, <span class="math notranslate nohighlight">\(\kappa_i^\beta(t)]\)</span> be the status of agent <span class="math notranslate nohighlight">\(i\)</span> obtained from the perception module and the ground truth, respectively.
Then, the  trace can be denoted as <span class="math notranslate nohighlight">\(\pi = \langle \mathbf{x}(t_0), \mathbf{x}(t_1), \ldots, \mathbf{x}(t_n) \rangle\)</span>, where <span class="math notranslate nohighlight">\(\mathbf{x}(t)= [X_0(t), X_i^\alpha(t), X_i^\beta(t)]\)</span>.</p>
<div class="section" id="expression-semantics">
<h2>Expression Semantics<a class="headerlink" href="#expression-semantics" title="Permalink to this headline">¶</a></h2>
<p>For the expression semantics, we explain the computation of perception difference, position distance, velocity distance, speed distance, and acceleration distance.</p>
<p><code class="docutils literal notranslate"><span class="pre">Defination</span> <span class="pre">5</span></code>: Given the perception result <span class="math notranslate nohighlight">\(X_i^\alpha\)</span> and the ground truth <span class="math notranslate nohighlight">\(X_i^\beta\)</span> of an agent <span class="math notranslate nohighlight">\(i\)</span>, the perception difference at time instant <span class="math notranslate nohighlight">\(t\)</span> is defined as the weighted sum of the errors of position, orientation, velocity, and shape.</p>
<div class="math notranslate nohighlight">
\[\begin{split}diff(X_i^\alpha, X_i^\beta)(t) = &amp; w_1 d_1(p_i^\alpha(t), p_i^\beta(t)) + w_2 d_2(q_i^\alpha(t), q_i^\beta(t))\\
+ &amp; w_3 d_3(v_i^\alpha(t), v_i^\beta(t)) + w_4 d_4(\kappa_i^\alpha(t), \kappa_i^\beta(t))\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(d_1(p_i^\alpha(t), p_i^\beta(t))=\|p_i^\alpha(t) - p_i^\beta(t)\|_2\)</span>, <span class="math notranslate nohighlight">\(d_2(q_i^\alpha(t), q_i^\beta(t))=  \arccos{q_i^\alpha(t)\dot q_i^\beta(t)}, \|p_i^\alpha(t) - p_i^\beta(t)\|_2\)</span>, <span class="math notranslate nohighlight">\(d_3(v_i^\alpha(t), v_i^\beta(t))=\|v_i^\alpha(t)- v_i^\beta(t)\|_2\)</span>, <span class="math notranslate nohighlight">\(d_4(\kappa_i^\alpha(t), \kappa_i^\beta(t)) = 1- \frac{|\kappa_i^\alpha(t) \bigcap \kappa_i^\beta(t)|}{|\kappa_i^\beta(t)|}\)</span>, <span class="math notranslate nohighlight">\(|\kappa|\)</span> denotes the area of the polygon <span class="math notranslate nohighlight">\(\kappa\)</span>, and <span class="math notranslate nohighlight">\(w_1-w_4\)</span> are normalized weights satisfying <span class="math notranslate nohighlight">\(w_1+w_2+w_3+w_4=1\)</span>.</p>
<p>Let <span class="math notranslate nohighlight">\(f_\kappa\)</span>,  <span class="math notranslate nohighlight">\(f_s\)</span>, <span class="math notranslate nohighlight">\(f_v\)</span>, <span class="math notranslate nohighlight">\(f_a\)</span> be the mappings of position region, speed, velocity, and acceleration from the object status, respectively. Then we have the following semantics for position, speed, velocity, and acceleration expressions.</p>
<a class="reference internal image-reference" href="_images/equation1.png"><img alt="equation1" class="align-center" src="_images/equation1.png" style="width: 300px;" /></a>
<p><code class="docutils literal notranslate"><span class="pre">Defination</span> <span class="pre">6</span></code>: Given two signals <span class="math notranslate nohighlight">\(e_1\)</span> and <span class="math notranslate nohighlight">\(e_2\)</span>, the computations of <span class="math notranslate nohighlight">\(dis(e_1,e_2)\)</span>, <span class="math notranslate nohighlight">\(spd(e_1,e_2)\)</span>, <span class="math notranslate nohighlight">\(vel(e_1,e_2)\)</span>, <span class="math notranslate nohighlight">\(acc(e_1,e_2)\)</span> is defined as follows.</p>
<div class="math notranslate nohighlight">
\[\begin{split}dis(e_1, e_2)(t) = &amp;\min_{\substack{p_1\in f_\kappa(e_1(t)), \\ p_2\in f_\kappa(e_2(t))}} \| p_1- p_2\|_2, e_1, e_2\in X \cup \{p\} \\%\{X^e, X_i^\alpha, X_i^\beta, p\}\\
spd(e_1, e_2)(t) = &amp;f_s(e_1(t)) - f_s(e_2(t)), e_1, e_2\in X \cup \{ vs\}\\
vel(e_1, e_2)(t) = &amp;\|f_v(e_1(t)) - f_v(e_2(t))\|_2, e_1, e_2\in X \cup \{v\}\\
acc(e_1, e_2)(t) = &amp; \|f_a(e_1(t)) - f_a(e_2(t))\|_2, e_1, e_2\in X \cup \{ a\}\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(X=\{X^e(t), X_i^\alpha(t), X_i^\beta(t)\}\)</span>.</p>
</div>
<div class="section" id="satistic-semantics">
<h2>Satistic Semantics<a class="headerlink" href="#satistic-semantics" title="Permalink to this headline">¶</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">Defination</span> <span class="pre">7</span></code>: [Satisfaction Semantics]
Given an assertion <span class="math notranslate nohighlight">\(\phi\)</span> from AVUnit’s syntax, the satisfaction relation of the assertion <span class="math notranslate nohighlight">\(\phi\)</span> with respect to a trace <span class="math notranslate nohighlight">\(\pi\)</span> at time <span class="math notranslate nohighlight">\(t\)</span> can be defined as:</p>
<div class="math notranslate nohighlight">
\[\begin{split}(\pi,t)  &amp; \vDash   \mu &amp; \iff &amp; f(\pi)(t) \geq 0\\
(\pi,t)  &amp; \vDash   \neg \phi &amp;  \iff &amp;  -((\pi,t)
\vDash \phi) \\
(\pi,t)  &amp; \vDash  \ \phi_1 \land \phi_2 &amp; \iff &amp; (\pi,t)   \vDash  \ \phi_1 \land (\pi,t)   \vDash  \ \phi_2\\
(\pi,t)  &amp; \vDash  \ \phi_1 \lor \phi_2 &amp; \iff &amp; (\pi,t)   \vDash  \ \phi_1 \lor (\pi,t)   \vDash  \ \phi_2\\
(\pi,t)  &amp; \vDash  \phi_1 \;\mathcal{U_I}\; \phi_2 &amp; \iff &amp; \exists t' \in t+\mathcal{I} \text{ such that } (\pi,t') \vDash \phi_2 \land \\
&amp; &amp;&amp;\forall t'' \in [t,t'], (x,t'') \vDash \phi_1\\
(\pi,t)  &amp; \vDash  \Diamond_\mathcal{I}\phi &amp; \iff &amp; \exists t' \in t+\mathcal{I} \text{ such that } (\pi,t') \vDash \phi\\
(\pi,t)  &amp; \vDash  \Box_\mathcal{I}\phi&amp; \iff &amp;
\forall t' \in t+\mathcal{I},\  (\pi,t') \vDash \phi\\
(\pi,t)  &amp; \vDash  \bigcirc \phi&amp; \iff &amp;
 (\pi,t+1) \vDash \phi\end{split}\]</div>
</div>
<div class="section" id="quantitative-semantics">
<h2>Quantitative Semantics<a class="headerlink" href="#quantitative-semantics" title="Permalink to this headline">¶</a></h2>
<p>In AVUnit, we applies the quantitative semantics of STL to measure the satisfaction of an AVUnit assertion.</p>
<p>Based on the satisfaction semantics, in the following, we define the quantitative semantics for AVUnit, which allows us to evaluate not only whether an AVUnit formula <span class="math notranslate nohighlight">\(\phi\)</span> is satisfied but also how far it is from being violated or satisfied.</p>
<p><code class="docutils literal notranslate"><span class="pre">Defination</span> <span class="pre">8</span></code>: [Quantitative Semantics]
Given a trace <span class="math notranslate nohighlight">\(\pi\)</span> and an AVSpec assertion <span class="math notranslate nohighlight">\(\phi\)</span> which is defined according to the above syntax, the quantitative semantics is defined as the robustness degree <span class="math notranslate nohighlight">\(\rho(\phi, \pi,t)\)</span> which returns a real value. The function <span class="math notranslate nohighlight">\(\rho\)</span> is defined as follows.</p>
<div class="math notranslate nohighlight">
\[\begin{split}\rho(\mu,\pi,t) &amp; = f(\pi) \\
\rho(\neg\phi,\pi,t) &amp; = -\rho(\phi,\pi,t) \\
\rho(\phi_1 \land \phi_2,\pi,t) &amp; = \min\{\rho(\phi_1,\pi,t),\rho(\phi_2,\pi,t)\} \\
\rho(\phi_1 \lor \phi_2,\pi,t) &amp; = \max\{\rho(\phi_1,\pi,t),\rho(\phi_2,\pi,t)\} \\
\rho(\phi_1 \;\mathcal{U_I}\; \phi_2,\pi,t) &amp; = \sup_{t'\in t+I}\ \min \{\rho(\phi_2,\pi,t'), \inf_{t'' \in [t,t']} \rho(\phi_1,\pi,t'')\} \\
\rho(\Diamond_\mathcal{I}\phi,\pi,t) &amp; = \sup_{t'\in t+\mathcal{I}}\rho(\phi,\pi,t') \\
\rho(\Box_\mathcal{I}\phi,\pi,t) &amp; = \inf_{t'\in t+\mathcal{I}}\rho(\phi,\pi,t')\\
\rho(\bigcirc \phi,\pi,t) &amp; = \rho(\phi,\pi,t+1)\end{split}\]</div>
<p>For example, suppose the distance sequence between the ego vehicle and the NPC vehicle <span class="math notranslate nohighlight">\(npc1\)</span> is <span class="math notranslate nohighlight">\(\pi_d = \{(t, d): (t_0, 10)\)</span>, <span class="math notranslate nohighlight">\((t_1, 8.69)\)</span>, <span class="math notranslate nohighlight">\((t_2, 7.32)\)</span>, <span class="math notranslate nohighlight">\((t_3, 6.3)\)</span>, <span class="math notranslate nohighlight">\((t_4, 5.4)\)</span>, <span class="math notranslate nohighlight">\((t_5, 4.5)\)</span>, <span class="math notranslate nohighlight">\((t_6, 5.0)\)</span>, <span class="math notranslate nohighlight">\(\ldots\)</span>, <span class="math notranslate nohighlight">\((t_n, d_n)\)</span>, <span class="math notranslate nohighlight">\(\ldots\}\)</span> where <span class="math notranslate nohighlight">\(d_n &gt; 5.0\)</span> when <span class="math notranslate nohighlight">\(t_n&gt;t_6\)</span>, and the related assertion is <span class="math notranslate nohighlight">\(\mu = G (d&gt;3.0)\)</span>, then we have <span class="math notranslate nohighlight">\(\rho(\mu, \pi_d, t_0) = 1.5\)</span>, where the minimal one is reached at <span class="math notranslate nohighlight">\(t_5\)</span>. It means that the assertion <span class="math notranslate nohighlight">\(\mu\)</span> is satisfied for <span class="math notranslate nohighlight">\(\pi_d\)</span>.</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="Overall_BNF.html" class="btn btn-neutral float-right" title="Overall BNF" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="Build_specifications_by_AVUnit.html" class="btn btn-neutral float-left" title="Define Specifications by AVUnit" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2021, SUN Yang.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>